<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: Home.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: Home.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { useEffect, useState } from 'react';
import Feed from '../Feed';
import FriendsWidget from '../FriendsWidget';
import UtilityWidget from '../UtilityWidget';
import LibraryWidget from '../LibraryWidget';
import ProfileWidget from '../ProfileWidget';
import styled from "styled-components";
import axios from "axios";
import { auth} from "../../firebase";

const HomeContainer = styled.div`
  display: flex;
  flex-direction: row;
  // align-items: center;
  justify-content: center;
  margin: auto;
  width: 100%;
`;

const WidgetColumn = styled.div`
  display: grid;
  grid-template-rows: 1fr 7fr;
  flex: 1;
`;

/**
 * Component for showing home page
 *
 * @component
 * @example
 * const username = krishpatel
 * const playlistCount = '3'
 * return (
 *   &lt;HomeContainer>
 *     &lt;WidgetColumn>
 *       &lt;UtilityWidget />
 *       &lt;LibraryWidget playlists={userPlaylists} />
 *     &lt;/WidgetColumn>
 *     &lt;Feed playlists={feed} />
 *     &lt;WidgetColumn>
 *       &lt;ProfileWidget user={user} friendCount={friends.length} />
 *       &lt;FriendsWidget friends={friends} />
 *     &lt;/WidgetColumn>
 *   &lt;/HomeContainer>
 * );
 */
const Home = () => {
  const [user, setUser] = useState({
    username: "username",
    profilePictureUrl: "/img/pig.jpeg",
    playlistCount: 0,
    // playlists: [
    //   {
    //     createdBy: {
    //       username: "Creator 1",
    //       profilePictureUrl: "/img/pig.jpeg"
    //     },
    //     coverPhotoUrl: "/img/pig.jpeg",
    //     name: "Playlist 1",
    //     description: "lorem ipsum dolor sit amet playlist description here",
    //     likesCount: 10,
    //     duration: "30m 31s",
    //     songs: [
    //       {
    //         name: "Song 1",
    //         artists: ["Artist 1"],
    //         imageUrl: "/img/pig.jpeg",
    //         album: "Album 1",
    //         duration: "3:00"
    //       },
    //     ]
    //   },
    // ],
  });
  const [userPlaylists, setPlaylists] = useState([]);
  const [feed, setFeed] = useState([]);
  const [friends, setFriends] = useState([
    {
      name: "Friend 1",
      profilePicture: "/img/pig.jpeg"
    },
    {
      name: "Friend 2",
      profilePicture: "/img/pig.jpeg"
    },
  ]);

  useEffect(() => {
    const getUser = async () => {
      // fetch user data
      const userId = auth.currentUser.uid;
      const userInfo = await axios.get(import.meta.env.VITE_BACKEND_URL + "/api/social/" + userId).then(res => res.data);

      const playlists = await axios.get(import.meta.env.VITE_BACKEND_URL + "/api/playlists/get/" + userId).then(res => res.data);
      setPlaylists(playlists);

      const feed = await axios.get(import.meta.env.VITE_BACKEND_URL + "/api/playlists/feed/" + userId).then(res => res.data);
      setFeed(feed);           
      
      setUser({...user, ...userInfo, playlistCount: playlists.length});

      // fetch friends
      let following = await axios.get(import.meta.env.VITE_BACKEND_URL + "/api/social/following/" + userId).then(res => res.data);
      const promises = following.map(async f => {
        const friend = await axios.get(import.meta.env.VITE_BACKEND_URL + "/api/profile/" + f).then(res => res.data);
        return {userId: f, profilePicture: friend.profilePictureUrl, name: friend.username};
      })
      following = await Promise.all(promises);
      setFriends(following);
    }
    getUser();
  }, []);

  return (
    &lt;HomeContainer>
      &lt;WidgetColumn>
        &lt;UtilityWidget />
        &lt;LibraryWidget playlists={userPlaylists} />
      &lt;/WidgetColumn>
      &lt;Feed playlists={feed} />
      &lt;WidgetColumn>
        &lt;ProfileWidget user={user} friendCount={friends.length} />
        &lt;FriendsWidget friends={friends} />
      &lt;/WidgetColumn>
    &lt;/HomeContainer>
  );
};

export default Home;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#Home">Home</a></li><li><a href="global.html#Inbox">Inbox</a></li><li><a href="global.html#Login">Login</a></li><li><a href="global.html#Profile">Profile</a></li><li><a href="global.html#Signup">Signup</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Fri Mar 15 2024 21:24:29 GMT-0700 (Pacific Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
